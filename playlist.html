<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="utf-8">
      <title>Playlists</title>
      <script src="https://kit.fontawesome.com/12a41c30dd.js" crossorigin="anonymous"></script>
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <link rel="stylesheet" type="text/css" href="playlist.css">
</head>
<body>
      <!-- Header Section  -->

      <header>
            <nav class="navbar">
                  <div id="navbar" style="padding: 0px;">
                        <div class="navbar-left">
                              <ul>
                              <li><a href="profil.html" onclick="toggleProfilePage()">
                                    <span style="margin-right: 2px;">Profil</span>
                                    <i class="fas fa-user-circle"></i>
                              </a></li>   
                              <li id="zenek"><a href="index.html" style="display: flex; align-items: center; margin-right: 4px;">
                                    <span style="margin-right: 3px;">Főmenü</span>
                                    <i class="fa fa-solid fa-music"></i>
                              </a></li>  
                              <li id="zenek"><a href="#" style="display: flex; align-items: center; margin-right: 4px;">
                                    <span style="margin-right: 3px;">Lejátszási Listáim</span>
                                    <i class="fa-solid fa-bars"></i>
                              </a></li>   
                              </ul>
                        </div>
                        
                        <div class="search-container trans-bg">
                              <form class="from1" method="post" id="search-form">
                                  <input type="text" class="search-bar" id="searchbar" placeholder="Keresés..">
                                  <button type="button" id="search-button"><i class="fa fa-search search-icon"></i></button>
                              </form>                                            
                          </div>
                        <div class="navbar-right">
                              <button class="button" style="margin-right: 25px;" onclick="bejelentkezes()">Bejelentkezés</button>
                        </div>
                  </div>
            </nav>
      </header>   
      
      <!-- Main Section  -->

      <main>
            <aside class="aside section-2" style="border-right: 5px solid rgb(17, 17, 102); padding: 12px;">
                  <h1 class="heading-text inline">Soron következő zenék</h1>
                <div id="search-results">
                   
                </div>
                  <h1 class="heading-text inline" onclick="hidePlaylistItem(event)">Lejátszási Listáid <i class="toggleIcon fa-solid fa-minus" style="float: right; margin-top: 2%; font-size: 26px; cursor: pointer;"></i></h1>
                  <div class="playlist">
                        <div class="playlist-item">
                              <div class="grid-container">
                                    <div class="grid-item">
                                          <img src="images/End Game.jpg" alt="">
                                          <div class="lejnev">Lejátszási lista 1</div>
                                    </div>
                              </div>  
                        </div>
                  </div>
            </aside>

            <aside class="section-1">
                  <h1 class="playlist-name">Kiválasztott lejátszási lista neve</h1>
                  <button class="play-button" onclick="playAll()">Összes Lejátszása</button>
                  <div class="menusong">
                        <li class="songitem">
                              <span>1</span>
                              <img src="images/End Game.jpg" alt="">
                              <h5>End Game <br>
                                    <div class="subtitle">Taylor Swift</div>
                              </h5>
                              <p>Pop Zene</p>
                              <p>2023.12.18</p>
                              <i class="fa-regular heartList fa-heart" onclick="toggleHeart(this)"></i>
                              <div class="idotartam">3:33</div>
                              <i class="fa-solid fa-ellipsis more"></i>
                        </li>
                        <li class="songitem">
                              <span>1</span>
                              <img src="images/End Game.jpg" alt="">
                              <h5>End Game <br>
                                    <div class="subtitle">Taylor Swift</div>
                              </h5>
                              <p>Pop Zene</p>
                              <p>2023.12.18</p>
                              <i class="fa-regular heartList fa-heart" onclick="toggleHeart(this)"></i>
                              <div class="idotartam">3:33</div>
                              <i class="fa-solid fa-ellipsis more"></i>
                        </li>
                  </div>
            </aside>
      </main>

      <!-- Footer:- Music Palyer Controls  -->

      <footer>
            <div class="play-song-info trans-bg">
                  <div class="con-left trans-bg">
                        <div class="footer-img">
                              <img class="small-img inline-block" src="images/End Game.jpg" alt=""> 
                        </div>
                        <div class="trans-bg">
                              <div class="font-mid trans-bg">End Game</div>
                              <p class="trans-bg">Taylor Swift</p>
                        </div> 
                  </div>    
                  <div class="con-right trans-bg side-margin-4px">
                        <i class="fa-solid fa-ban" style="cursor: pointer;"></i>
                        <div class="heartIcon"><i class="fa-regular fa-heart" style="cursor: pointer;" onclick="toggleHeart(this)"></i></div>
                  </div>
            </div>

            <div class="player trans-bg">
            <div class="buttons">
                  <div class="random-track">
                        <i class="fa-solid fa-shuffle" title="random"></i>
                  </div>
                  <div class="prev-track">
                        <i class="fa-solid fa-backward-step"></i>
                  </div>
                  <div class="playpause-track">
                        <i class="fa-solid fa-play" onclick="handlePlay(this)"></i>
                  </div>
                  <div class="next-track">
                        <i class="fa-solid fa-forward-step"></i>
                  </div>
                  <div class="repeat-track">
                        <i class="fa-solid fa-arrow-rotate-right" title="repeat"></i>
                  </div>
            </div>
            <div class="slider_container">
                  <div class="current-time">00:00</div>
                  <input type="range" min="1" max="100" value="0" class="seek_slider">
                  <div class="total-duration">00:00</div>
            </div>
            </div>
            <div class="extras trans-bg">
            <div class="slider_container">
                  <i class="fa fa-volume-down"></i>
                  <input type="range" min="1" max="100" value="99" class="volume_slider">
                  <i class="fa fa-volume-up"></i>
            </div>
            <div></div>
            </div>
      </footer>
      <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
      <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

      <script>
            function bejelentkezes()
            {
            window.location.href = "regbej.html";
            }

            function hidePlaylistItem(event) {
            var clickedElement = event.target;

            if (clickedElement.classList.contains("toggleIcon")) {
                  var playlistItem = clickedElement.parentElement.nextElementSibling;
                  var icon = clickedElement;

                  if (icon.classList.contains("fa-minus")) {
                        icon.classList.remove("fa-minus");
                        icon.classList.add("fa-plus");
                        playlistItem.style.display = "none";
                  } else {
                        icon.classList.remove("fa-plus");
                        icon.classList.add("fa-minus");
                        playlistItem.style.display = "block";
                  }
            }
            }

            function toggleHeart(event) {
                  if (event.classList.contains("fa-regular")) {
                        event.classList.remove("fa-regular");
                        event.classList.add("fa-solid");
                  } else {
                        event.classList.remove("fa-solid");
                        event.classList.add("fa-regular");
                  }
            }   

            function handlePlay(event) {
                  if (event.classList.contains("fa-play")) {
                  event.classList.remove("fa-play");
                  event.classList.add("fa-pause");
                  } else {
                  event.classList.remove("fa-pause");
                  event.classList.add("fa-play");
                  }
            }

            var typingTimer;
            var doneTypingInterval = 100; 

            function performSearch() {
                clearTimeout(typingTimer);
                
                typingTimer = setTimeout(function () {
                    var searchQuery = document.getElementById("searchbar").value.trim();
                    if (searchQuery !== "") {
                        var xhr = new XMLHttpRequest();
                        xhr.open("POST", "search.php", true);
                        xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                        xhr.onreadystatechange = function () {
                            if (xhr.readyState == 4) {
                                if (xhr.status == 200) {
                                    try {
                                        var results = JSON.parse(xhr.responseText);
                                        updateList(results);
                                    } catch (error) {
                                        console.error("Error parsing JSON:", error.message);
                                        clearList();
                                    }
                                } else {
                                    console.error("Request failed with status:", xhr.status);
                                    clearList();
                                }
                            }
                        };
                        xhr.send("query=" + searchQuery);
                    } else {
                        clearList();
                    }
                }, doneTypingInterval);
            }

            function clearList() {
                var resultList = document.getElementById("search-results");
                resultList.innerHTML = "";
            }

            document.getElementById("searchbar").addEventListener("keyup", performSearch);
            document.getElementById("search-button").addEventListener("click", performSearch);

            function updateList(results) {
                var resultList = document.getElementById("search-results");
                resultList.innerHTML = "";

                if (results && results.length > 0) {
                    var ul = document.createElement("ul");
                    for (var i = 0; i < results.length; i++) {
                        var li = document.createElement("li");
                        li.textContent = results[i].cim + " - " + results[i].szerzo;
                        ul.appendChild(li);
                    }
                    resultList.appendChild(ul);
                }
            }      
      </script>
</body>
</html>